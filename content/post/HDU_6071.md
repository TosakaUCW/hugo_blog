+++
title = 'HDU 6071 Lazy Running（同余最短路）'
date = 2020-10-23T19:29:45+08:00
categories = ['题解']
tags = ['同余最短路']
+++

[题目链接](http://acm.hdu.edu.cn/showproblem.php?pid=6071)

{{% question %}}

给定 4 个点的环，求从 2 出发回到 2 的最短的长度至少为 K 的路径长度。

$K \le 10^{18}$

$d \le 3 \times 10^4$

{{% /question %}}

<!--more-->

## 简要做法

取 $w = min(d_{1,2}, d_{2,3})$，那么对于每一种方案，均可以通过往返跑 $w$ 这条边使得距离增加 $2w$

也就是说，如果存在距离为 $k$ 的方案，那么必然存在距离为 $k + 2w$ 的方案

设 $dis_{i,j}$ 表示从起点出发到达 $i$，距离模 $2w$ 为 $j$ 时的最短路

根据 $dis_{2,j}$ 解不等式即可得到最优路线

时间复杂度 $O(w log w)$

## 参考代码

```cpp

```
